 kaustavghosh@WQ7X9RQ6YW  ~/Desktop/agent-catalog-quickstart/notebooks/flight_search_agent_langraph  ↱ main  poetry run python evals/eval_arize.py
2025-08-30 18:03:23,411 - phoenix.config - INFO - 📋 Ensuring phoenix working directory: /Users/kaustavghosh/.phoenix
2025-08-30 18:03:23,432 - phoenix.inferences.inferences - INFO - Dataset: phoenix_inferences_329ddbd7-a4b2-4a2a-881c-c878ce697171 initialized
2025-08-30 18:03:27,918 - __main__ - INFO - ✅ Arize datasets client initialized successfully
2025-08-30 18:03:27,980 - __main__ - INFO - ✅ Phoenix evaluators initialized successfully
2025-08-30 18:03:27,980 - __main__ - INFO -    🤖 Using evaluator model: gpt-4o
2025-08-30 18:03:27,980 - __main__ - INFO -    📊 Available evaluators: ['relevance', 'qa_correctness', 'hallucination', 'toxicity']
2025-08-30 18:03:27,980 - __main__ - INFO - 🔧 Setting up Phoenix observability...
2025-08-30 18:03:30,125 - alembic.runtime.migration - INFO - Context impl SQLiteImpl.
2025-08-30 18:03:30,125 - alembic.runtime.migration - INFO - Will assume transactional DDL.
2025-08-30 18:03:30,137 - alembic.runtime.migration - INFO - Running upgrade  -> cf03bd6bae1d, init
2025-08-30 18:03:30,164 - alembic.runtime.migration - INFO - Running upgrade cf03bd6bae1d -> 10460e46d750, datasets
2025-08-30 18:03:30,169 - alembic.runtime.migration - INFO - Running upgrade 10460e46d750 -> 3be8647b87d8, add token columns to spans table
2025-08-30 18:03:30,171 - alembic.runtime.migration - INFO - Running upgrade 3be8647b87d8 -> cd164e83824f, users and tokens
2025-08-30 18:03:30,175 - alembic.runtime.migration - INFO - Running upgrade cd164e83824f -> 4ded9e43755f, create project_session table
2025-08-30 18:03:30,183 - alembic.runtime.migration - INFO - Running upgrade 4ded9e43755f -> bc8fea3c2bc8, Add prompt tables
2025-08-30 18:03:30,187 - alembic.runtime.migration - INFO - Running upgrade bc8fea3c2bc8 -> 2f9d1a65945f, Annotation config migrations
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py:144: SAWarning: Skipped unsupported reflection of expression-based index ix_cumulative_llm_token_count_total
  next(self.gen)
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py:144: SAWarning: Skipped unsupported reflection of expression-based index ix_latency
  next(self.gen)
2025-08-30 18:03:30,247 - alembic.runtime.migration - INFO - Running upgrade 2f9d1a65945f -> bb8139330879, create project trace retention policies table
2025-08-30 18:03:30,251 - alembic.runtime.migration - INFO - Running upgrade bb8139330879 -> 8a3764fe7f1a, change jsonb to json for prompts
2025-08-30 18:03:30,349 - alembic.runtime.migration - INFO - Running upgrade 8a3764fe7f1a -> 6a88424799fe, Add auth_method column to users table and migrate existing authentication data.
2025-08-30 18:03:30,355 - alembic.runtime.migration - INFO - Running upgrade 6a88424799fe -> a20694b15f82, Cost-related tables
🌍 To view the Phoenix app in your browser, visit http://localhost:6007/
📖 For more information on how to use Phoenix, check out https://arize.com/docs/phoenix
2025-08-30 18:03:30,578 - __main__ - INFO - 🌐 Phoenix UI: http://localhost:6007/
🔭 OpenTelemetry Tracing Details 🔭
|  Phoenix Project: flight-search-agent-evaluation
|  Span Processor: SimpleSpanProcessor
|  Collector Endpoint: http://localhost:6007/v1/traces
|  Transport: HTTP + protobuf
|  Transport Headers: {}
|  
|  Using a default SpanProcessor. `add_span_processor` will overwrite this default.
|  
|  ⚠️ WARNING: It is strongly advised to use a BatchSpanProcessor in production environments.
|  
|  `register` has set this TracerProvider as the global OpenTelemetry default.
|  To disable this behavior, call `register` with `set_global_tracer_provider=False`.

2025-08-30 18:03:30,599 - __main__ - INFO - ✅ Phoenix setup completed successfully
2025-08-30 18:03:30,604 - __main__ - INFO - ✅ LangChain instrumentation enabled
2025-08-30 18:03:30,606 - __main__ - INFO - ✅ OpenAI instrumentation enabled
2025-08-30 18:03:33,488 - shared.couchbase_client - INFO - ✅ Successfully connected to Couchbase
2025-08-30 18:03:34,947 - shared.couchbase_client - INFO - ✅ Connected to existing bucket 'travel-sample'
2025-08-30 18:03:34,947 - shared.couchbase_client - INFO - 🗑️ Clearing scope: travel-sample.agentc_bookings
2025-08-30 18:03:36,203 - shared.couchbase_client - INFO - 🗑️ Clearing data from travel-sample.agentc_bookings.user_bookings_20250830...
2025-08-30 18:03:40,165 - shared.couchbase_client - INFO - ✅ Cleared collection: travel-sample.agentc_bookings.user_bookings_20250830
2025-08-30 18:03:40,166 - shared.couchbase_client - INFO - 🗑️ Clearing data from travel-sample.agentc_bookings.user_bookings_20250829...
2025-08-30 18:03:43,415 - shared.couchbase_client - INFO - ✅ Cleared collection: travel-sample.agentc_bookings.user_bookings_20250829
2025-08-30 18:03:43,415 - shared.couchbase_client - INFO - ✅ Completed clearing scope: travel-sample.agentc_bookings
2025-08-30 18:03:43,416 - main - INFO - ✅ Cleared existing flight bookings for fresh test run: travel-sample.agentc_bookings
2025-08-30 18:03:43,464 - data.airline_reviews_data - INFO - Downloading Indian Airlines Customer Reviews dataset from Kaggle...
2025-08-30 18:03:49,406 - data.airline_reviews_data - INFO - Loading reviews from /Users/kaustavghosh/.cache/kagglehub/datasets/jagathratchakan/indian-airlines-customer-reviews/versions/1/Indian_Domestic_Airline.csv
2025-08-30 18:03:49,440 - data.airline_reviews_data - INFO - Loaded 2210 airline reviews from Kaggle dataset
2025-08-30 18:03:49,444 - data.airline_reviews_data - INFO - Processed 2210 airline reviews into text format
2025-08-30 18:03:50,737 - main - INFO - 📊 Airline reviews collection: 1131 existing, 2210 expected
2025-08-30 18:03:50,737 - main - INFO - 🗑️  Clearing airline reviews collection: travel-sample.agentc_data.airline_reviews
2025-08-30 18:03:50,737 - shared.couchbase_client - INFO - 🗑️ Clearing data from travel-sample.agentc_data.airline_reviews...
2025-08-30 18:03:54,521 - shared.couchbase_client - INFO - ✅ Collection cleared successfully, 0 documents remaining
2025-08-30 18:03:54,522 - main - INFO - ✅ Cleared existing airline reviews for fresh data load: travel-sample.agentc_data.airline_reviews
2025-08-30 18:03:54,527 - __main__ - INFO - 🔧 Setting up flight search agent...
2025-08-30 18:03:54,528 - shared.agent_setup - INFO - ✅ Environment variables configured
2025-08-30 18:03:59,077 - shared.couchbase_client - INFO - ✅ Successfully connected to Couchbase
2025-08-30 18:04:00,588 - shared.couchbase_client - INFO - ✅ Connected to existing bucket 'travel-sample'
2025-08-30 18:04:03,085 - shared.couchbase_client - INFO - ℹ️ Collection 'airline_reviews' exists, keeping existing data
2025-08-30 18:04:07,341 - shared.couchbase_client - INFO - ✅ Primary index created successfully
2025-08-30 18:04:07,342 - shared.couchbase_client - INFO - ✅ Collection setup complete: agentc_data.airline_reviews
2025-08-30 18:04:07,346 - main - INFO - Loaded vector search index definition from agentcatalog_index.json
2025-08-30 18:04:08,565 - shared.couchbase_client - INFO - ℹ️ Vector search index 'airline_reviews_index' already exists
2025-08-30 18:04:08,566 - shared.agent_setup - INFO - 🔧 Setting up AI services for langgraph framework...
2025-08-30 18:04:09,010 - shared.agent_setup - INFO - ✅ Using latest Capella AI embeddings (direct API key + OpenAI wrapper)
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1756557249.036879 14879991 fork_posix.cc:71] Other threads are currently calling into gRPC, skipping fork() handlers
I0000 00:00:1756557249.072904 14879991 fork_posix.cc:71] Other threads are currently calling into gRPC, skipping fork() handlers
2025-08-30 18:04:10,731 - shared.agent_setup - INFO - ✅ Using latest Capella AI LLM (direct API key + OpenAI wrapper)
2025-08-30 18:04:10,731 - shared.agent_setup - INFO - ✅ AI services setup completed for langgraph
2025-08-30 18:04:10,731 - shared.couchbase_client - INFO - 🔄 Loading data into vector store...
/Users/kaustavghosh/Desktop/agent-catalog-quickstart/notebooks/flight_search_agent_langraph/data/airline_reviews_data.py:156: LangChainDeprecationWarning: The class `CouchbaseVectorStore` was deprecated in LangChain 0.3.0 and will be removed in 1.0.0. An updated version of the class exists in the :class:`~langchain-couchbase package and should be used instead. To use it run `pip install -U :class:`~langchain-couchbase` and import as `from :class:`~langchain_couchbase.vectorstores import CouchbaseSearchVectorStore``.
  vector_store = CouchbaseVectorStore(
2025-08-30 18:04:15,663 - data.airline_reviews_data - INFO - Loading 2210 airline review embeddings to travel-sample.agentc_data.airline_reviews
I0000 00:00:1756557255.666244 14879991 fork_posix.cc:71] Other threads are currently calling into gRPC, skipping fork() handlers
Loading airline reviews: 100%|██████████████| 2210/2210 [03:31<00:00, 10.46reviews/s, batch=221/221]
2025-08-30 18:07:47,037 - data.airline_reviews_data - INFO - Successfully loaded 2210 airline review embeddings to vector store
2025-08-30 18:07:47,037 - shared.couchbase_client - INFO - ✅ Data loaded into vector store successfully
2025-08-30 18:07:51,055 - shared.couchbase_client - INFO - ✅ LangChain vector store setup complete: travel-sample.agentc_data.airline_reviews
2025-08-30 18:07:51,055 - shared.agent_setup - INFO - 🔧 Setting up AI services for langgraph framework...
2025-08-30 18:07:51,084 - shared.agent_setup - INFO - ✅ Using latest Capella AI embeddings (direct API key + OpenAI wrapper)
2025-08-30 18:07:52,589 - shared.agent_setup - INFO - ✅ Using latest Capella AI LLM (direct API key + OpenAI wrapper)
2025-08-30 18:07:52,589 - shared.agent_setup - INFO - ✅ AI services setup completed for langgraph
2025-08-30 18:09:13,698 - main - INFO - Agent Catalog integration successful
2025-08-30 18:09:13,701 - __main__ - INFO - ✅ Flight search agent setup completed successfully
2025-08-30 18:09:13,701 - __main__ - INFO - 🚀 Starting evaluation with 5 queries
2025-08-30 18:09:13,701 - __main__ - INFO - 📋 Evaluation Configuration:
2025-08-30 18:09:13,701 - __main__ - INFO -    🤖 Agent: Flight Search Agent (LangGraph)
2025-08-30 18:09:13,701 - __main__ - INFO -    🔧 Phoenix Available: ✅
2025-08-30 18:09:13,701 - __main__ - INFO -    📊 Arize Datasets: ✅
2025-08-30 18:09:13,701 - __main__ - INFO -    🧠 Phoenix Evaluators: ['relevance', 'qa_correctness', 'hallucination', 'toxicity']
2025-08-30 18:09:13,701 - __main__ - INFO - 
📋 Query 1/5
2025-08-30 18:09:13,701 - __main__ - INFO - 🔍 Evaluating query: Find flights from JFK to LAX
2025-08-30 18:09:13,703 - main - INFO - Flight Query: Find flights from JFK to LAX
2025-08-30 18:09:13,784 - main - INFO - ✅ Found tool: lookup_flight_info
2025-08-30 18:09:13,794 - main - INFO - ✅ Found tool: save_flight_booking
2025-08-30 18:09:13,805 - main - INFO - ✅ Found tool: retrieve_flight_bookings
2025-08-30 18:09:13,813 - main - INFO - ✅ Found tool: search_airline_reviews


> Entering new AgentExecutor chain...
Action: lookup_flight_info
Action Input: source_airport="JFK", destination_airport="LAX"
Observation2025-08-30 18:09:15,838 - main - INFO - 🔧 Tool lookup_flight_info called with raw input: 'source_airport="JFK", destination_airport="LAX"\nObservation'
2025-08-30 18:09:15,838 - main - INFO - 🧹 Tool lookup_flight_info cleaned input: 'source_airport="JFK", destination_airport="LAX'
2025-08-30 18:09:17,106 - main - INFO - ✅ Tool lookup_flight_info executed successfully
Available flights from JFK to LAX:

1. AS flight from JFK to LAX using 321 762
2. B6 flight from JFK to LAX using 320
3. DL flight from JFK to LAX using 76W 752
4. QF flight from JFK to LAX using 744
5. AA flight from JFK to LAX using 32B 762
6. UA flight from JFK to LAX using 757
7. US flight from JFK to LAX using 32B 762
8. VX flight from JFK to LAX using 320Action: lookup_flight_info
Action Input: source_airport="JFK", destination_airport="LAX"
Observation2025-08-30 18:09:17,891 - main - INFO - 🔧 Tool lookup_flight_info called with raw input: 'source_airport="JFK", destination_airport="LAX"\nObservation'
2025-08-30 18:09:17,892 - main - INFO - 🧹 Tool lookup_flight_info cleaned input: 'source_airport="JFK", destination_airport="LAX'
2025-08-30 18:09:18,261 - main - INFO - ✅ Tool lookup_flight_info executed successfully
Available flights from JFK to LAX:

1. AS flight from JFK to LAX using 321 762
2. B6 flight from JFK to LAX using 320
3. DL flight from JFK to LAX using 76W 752
4. QF flight from JFK to LAX using 744
5. AA flight from JFK to LAX using 32B 762
6. UA flight from JFK to LAX using 757
7. US flight from JFK to LAX using 32B 762
8. VX flight from JFK to LAX using 320

> Finished chain.
2025-08-30 18:09:18,284 - __main__ - INFO - ✅ Query completed in 4.58s
2025-08-30 18:09:18,284 - __main__ - INFO - 
📋 Query 2/5
2025-08-30 18:09:18,284 - __main__ - INFO - 🔍 Evaluating query: Book a flight from LAX to JFK for tomorrow, 2 passengers, business class
2025-08-30 18:09:18,285 - main - INFO - Flight Query: Book a flight from LAX to JFK for tomorrow, 2 passengers, business class
2025-08-30 18:09:18,386 - main - INFO - ✅ Found tool: lookup_flight_info
2025-08-30 18:09:18,395 - main - INFO - ✅ Found tool: save_flight_booking
2025-08-30 18:09:18,406 - main - INFO - ✅ Found tool: retrieve_flight_bookings
2025-08-30 18:09:18,421 - main - INFO - ✅ Found tool: search_airline_reviews


> Entering new AgentExecutor chain...
Action: save_flight_booking
Action Input: source_airport="LAX", destination_airport="JFK", passengers=2, flight_class="business", departure_date="2025-08-31"
Observation2025-08-30 18:09:19,253 - main - INFO - 🔧 Tool save_flight_booking called with raw input: 'source_airport="LAX", destination_airport="JFK", passengers=2, flight_class="business", departure_date="2025-08-31"\nObservation'
2025-08-30 18:09:19,253 - main - INFO - 🧹 Tool save_flight_booking cleaned input: 'source_airport="LAX", destination_airport="JFK", passengers=2, flight_class="business", departure_date="2025-08-31'
2025-08-30 18:09:25,151 - main - INFO - ✅ Tool save_flight_booking executed successfully
Flight Booking Confirmed!

Booking ID: FL0831EE9EF079
Route: LAX → JFK
Departure Date: 2025-08-31
Passengers: 2
Class: business
Total Price: $1500.00

Next Steps:
1. Check-in opens 24 hours before departure
2. Arrive at airport 2 hours early for domestic flights
3. Bring valid government-issued photo ID

Thank you for choosing our airline!Question: Book a flight from LAX to JFK for tomorrow, 2 passengers, business class
Thought: I need to book a flight, so I will use the save_flight_booking tool.
Action: save_flight_booking
Action Input: source_airport="LAX", destination_airport="JFK", passengers=2, flight_class="business", departure_date="2025-08-31"
Observation2025-08-30 18:09:27,137 - main - INFO - 🔧 Tool save_flight_booking called with raw input: 'source_airport="LAX", destination_airport="JFK", passengers=2, flight_class="business", departure_date="2025-08-31"\nObservation'
2025-08-30 18:09:27,137 - main - INFO - 🧹 Tool save_flight_booking cleaned input: 'source_airport="LAX", destination_airport="JFK", passengers=2, flight_class="business", departure_date="2025-08-31'
2025-08-30 18:09:31,177 - main - INFO - ✅ Tool save_flight_booking executed successfully
Duplicate booking found! You already have a confirmed booking:
- Booking ID: FL0831EE9EF079
- Route: LAX → JFK
- Date: 2025-08-31
- Total: $1500.00

No new booking was created. Use the existing booking ID for reference.

> Finished chain.
2025-08-30 18:09:31,206 - __main__ - INFO - ✅ Query completed in 12.92s
2025-08-30 18:09:31,206 - __main__ - INFO - 
📋 Query 3/5
2025-08-30 18:09:31,206 - __main__ - INFO - 🔍 Evaluating query: Book an economy flight from JFK to MIA for next week, 1 passenger
2025-08-30 18:09:31,207 - main - INFO - Flight Query: Book an economy flight from JFK to MIA for next week, 1 passenger
2025-08-30 18:09:31,317 - main - INFO - ✅ Found tool: lookup_flight_info
2025-08-30 18:09:31,325 - main - INFO - ✅ Found tool: save_flight_booking
2025-08-30 18:09:31,339 - main - INFO - ✅ Found tool: retrieve_flight_bookings
2025-08-30 18:09:31,346 - main - INFO - ✅ Found tool: search_airline_reviews


> Entering new AgentExecutor chain...
Action: save_flight_booking
Action Input: source_airport="JFK", destination_airport="MIA", passengers=1, flight_class="economy", departure_date="2025-09-06"
Observation2025-08-30 18:09:32,159 - main - INFO - 🔧 Tool save_flight_booking called with raw input: 'source_airport="JFK", destination_airport="MIA", passengers=1, flight_class="economy", departure_date="2025-09-06"\nObservation'
2025-08-30 18:09:32,159 - main - INFO - 🧹 Tool save_flight_booking cleaned input: 'source_airport="JFK", destination_airport="MIA", passengers=1, flight_class="economy", departure_date="2025-09-06'
2025-08-30 18:09:36,533 - main - INFO - ✅ Tool save_flight_booking executed successfully
Flight Booking Confirmed!

Booking ID: FL090669F769C5
Route: JFK → MIA
Departure Date: 2025-09-06
Passengers: 1
Class: economy
Total Price: $250.00

Next Steps:
1. Check-in opens 24 hours before departure
2. Arrive at airport 2 hours early for domestic flights
3. Bring valid government-issued photo ID

Thank you for choosing our airline!Final Answer: The flight has been booked successfully. Booking ID: FL090669F769C5, Route: JFK → MIA, Departure Date: 2025-09-06, Passengers: 1, Class: economy, Total Price: $250.00. Please follow the next steps for a smooth travel experience.

> Finished chain.
2025-08-30 18:09:37,573 - __main__ - INFO - ✅ Query completed in 6.37s
2025-08-30 18:09:37,573 - __main__ - INFO - 
📋 Query 4/5
2025-08-30 18:09:37,573 - __main__ - INFO - 🔍 Evaluating query: Show me my current flight bookings
2025-08-30 18:09:37,574 - main - INFO - Flight Query: Show me my current flight bookings
2025-08-30 18:09:37,662 - main - INFO - ✅ Found tool: lookup_flight_info
2025-08-30 18:09:37,669 - main - INFO - ✅ Found tool: save_flight_booking
2025-08-30 18:09:37,678 - main - INFO - ✅ Found tool: retrieve_flight_bookings
2025-08-30 18:09:37,693 - main - INFO - ✅ Found tool: search_airline_reviews


> Entering new AgentExecutor chain...
Action: retrieve_flight_bookings
Action Input: ""
Observation2025-08-30 18:09:38,245 - main - INFO - 🔧 Tool retrieve_flight_bookings called with raw input: '\nObservation'
2025-08-30 18:09:38,245 - main - INFO - 🧹 Tool retrieve_flight_bookings cleaned input: ''
2025-08-30 18:09:39,427 - main - INFO - ✅ Tool retrieve_flight_bookings executed successfully
Your Current Bookings (2 found):

Booking 1:
  Booking ID: FL090669F769C5
  Route: JFK → MIA
  Date: 2025-09-06
  Passengers: 1
  Class: economy
  Total: $250.00
  Status: confirmed
  Booked: 2025-08-30

Booking 2:
  Booking ID: FL0831EE9EF079
  Route: LAX → JFK
  Date: 2025-08-31
  Passengers: 2
  Class: business
  Total: $1500.00
  Status: confirmed
  Booked: 2025-08-30Thought: I now know the final answer Final Answer: Your Current Bookings (2 found): Booking 1: Booking ID: FL090669F769C5 Route: JFK → MIA Date: 2025-09-06 Passengers: 1 Class: economy Total: $250.00 Status: confirmed Booked: 2025-08-30 Booking 2: Booking ID: FL0831EE9EF079 Route: LAX → JFK Date: 2025-08-31 Passengers: 2 Class: business Total: $1500.00 Status: confirmed Booked: 2025-08-30

> Finished chain.
2025-08-30 18:09:41,077 - __main__ - INFO - ✅ Query completed in 3.50s
2025-08-30 18:09:41,077 - __main__ - INFO - 
📋 Query 5/5
2025-08-30 18:09:41,077 - __main__ - INFO - 🔍 Evaluating query: What do passengers say about SpiceJet's service quality?
2025-08-30 18:09:41,078 - main - INFO - Flight Query: What do passengers say about SpiceJet's service quality?
2025-08-30 18:09:41,172 - main - INFO - ✅ Found tool: lookup_flight_info
2025-08-30 18:09:41,179 - main - INFO - ✅ Found tool: save_flight_booking
2025-08-30 18:09:41,187 - main - INFO - ✅ Found tool: retrieve_flight_bookings
2025-08-30 18:09:41,195 - main - INFO - ✅ Found tool: search_airline_reviews


> Entering new AgentExecutor chain...
Action: search_airline_reviews
Action Input: "SpiceJet service quality"
Observation2025-08-30 18:09:41,775 - main - INFO - 🔧 Tool search_airline_reviews called with raw input: 'SpiceJet service quality"\nObservation'
2025-08-30 18:09:41,775 - main - INFO - 🧹 Tool search_airline_reviews cleaned input: 'SpiceJet service quality'
2025-08-30 18:09:47,106 - search_airline_reviews - INFO - Searching for airline reviews with query: 'SpiceJet service quality'
2025-08-30 18:09:49,613 - search_airline_reviews - INFO - Found 5 results for query: 'SpiceJet service quality'
2025-08-30 18:09:49,614 - main - INFO - ✅ Tool search_airline_reviews executed successfully
Found 5 relevant airline reviews for 'SpiceJet service quality':

Review 1:
Airline: SpiceJet. Title: "good service by the crew". Review: ✅ Trip Verified | I have had good service by the crew. It was amazing, the crew was very enthusiastic and warm welcome. It was one of the best services in my experience.. Rating: 10.0/10. Reviewer: K Mansour. Date: 10th August 2024. Recom...

Review 2:
Airline: SpiceJet. Title: "excellent hospitality". Review: ✅ Trip Verified |  It's very grateful to SpiceJet for the service in flight. Everything is fine with excellent hospitality. Very politely behavior and warmly welcome from your cabin crew and all members.. Rating: 10.0/10. Reviewer: A Kajan. ...

Review 3:
Airline: SpiceJet. Title: "Great travel experience". Review: ✅ Trip Verified |  Marvelous courteous crew who took good care of all passengers. They should be rewarded for the patience shown towards the unruly ones. Great travel experience.. Rating: 10.0/10. Reviewer: Ranjita Pandey. Date: 18th April...

Review 4:
Airline: SpiceJet. Title: "Highly disappointed". Review: Not Verified |  Very poor services. Highly disappointed. Round trip flight was booked, cancelled my return flight and didn't even compensate or accomodate me in other flight.. Rating: 1.0/10. Reviewer: Mayank Baid. Date: 25th March 2023. Recom...

Review 5:
Airline: SpiceJet. Title: "Really worst experience". Review: ✅ Trip Verified |  First of all please don’t trust on SpiceJet. They never on time. They can kill your planning. Unlimited rescheduling. If you have any urgent work, inter change of flight be careful. Really worst experience.. Rating: 1.0/...Thought: I need to search airline reviews using the search_airline_reviews tool.
Action: search_airline_reviews
Action Input: "SpiceJet service quality"
Observation2025-08-30 18:09:51,299 - main - INFO - 🔧 Tool search_airline_reviews called with raw input: 'SpiceJet service quality"\nObservation'
2025-08-30 18:09:51,300 - main - INFO - 🧹 Tool search_airline_reviews cleaned input: 'SpiceJet service quality'
2025-08-30 18:09:55,241 - search_airline_reviews - INFO - Searching for airline reviews with query: 'SpiceJet service quality'
2025-08-30 18:09:57,607 - search_airline_reviews - INFO - Found 5 results for query: 'SpiceJet service quality'
2025-08-30 18:09:57,608 - main - INFO - ✅ Tool search_airline_reviews executed successfully
Found 5 relevant airline reviews for 'SpiceJet service quality':

Review 1:
Airline: SpiceJet. Title: "good service by the crew". Review: ✅ Trip Verified | I have had good service by the crew. It was amazing, the crew was very enthusiastic and warm welcome. It was one of the best services in my experience.. Rating: 10.0/10. Reviewer: K Mansour. Date: 10th August 2024. Recom...

Review 2:
Airline: SpiceJet. Title: "excellent hospitality". Review: ✅ Trip Verified |  It's very grateful to SpiceJet for the service in flight. Everything is fine with excellent hospitality. Very politely behavior and warmly welcome from your cabin crew and all members.. Rating: 10.0/10. Reviewer: A Kajan. ...

Review 3:
Airline: SpiceJet. Title: "Great travel experience". Review: ✅ Trip Verified |  Marvelous courteous crew who took good care of all passengers. They should be rewarded for the patience shown towards the unruly ones. Great travel experience.. Rating: 10.0/10. Reviewer: Ranjita Pandey. Date: 18th April...

Review 4:
Airline: SpiceJet. Title: "Highly disappointed". Review: Not Verified |  Very poor services. Highly disappointed. Round trip flight was booked, cancelled my return flight and didn't even compensate or accomodate me in other flight.. Rating: 1.0/10. Reviewer: Mayank Baid. Date: 25th March 2023. Recom...

Review 5:
Airline: SpiceJet. Title: "Really worst experience". Review: ✅ Trip Verified |  First of all please don’t trust on SpiceJet. They never on time. They can kill your planning. Unlimited rescheduling. If you have any urgent work, inter change of flight be careful. Really worst experience.. Rating: 1.0/...

> Finished chain.
2025-08-30 18:09:57,634 - __main__ - INFO - ✅ Query completed in 16.56s
2025-08-30 18:09:57,638 - __main__ - INFO - 🧠 Running Phoenix evaluations on 5 responses...
2025-08-30 18:09:57,639 - __main__ - INFO - 📋 Evaluation criteria:
2025-08-30 18:09:57,639 - __main__ - INFO -    🔍 Relevance: Does the response address the flight search query?
2025-08-30 18:09:57,639 - __main__ - INFO -    🎯 QA Correctness: Is the flight information accurate and helpful?
2025-08-30 18:09:57,639 - __main__ - INFO -    🚨 Hallucination: Does the response contain fabricated information?
2025-08-30 18:09:57,639 - __main__ - INFO -    ☠️ Toxicity: Is the response harmful or inappropriate?
2025-08-30 18:09:57,640 - __main__ - INFO -    📊 Running relevance evaluation...
llm_classify |███████████████████████████████████████████| 5/5 (100.0%) | ⏳ 00:03<00:00 |  1.47it/s2025-08-30 18:10:02,425 - __main__ - INFO -    ✅ relevance evaluation completed
2025-08-30 18:10:02,425 - __main__ - INFO -    📊 Running qa_correctness evaluation...
llm_classify |███████████████████████████████████████████| 5/5 (100.0%) | ⏳ 00:04<00:00 |  1.04it/s
llm_classify |                                                     | 0/5 (0.0%) | ⏳ 00:00<? | ?it/2025-08-30 18:10:07,105 - __main__ - INFO -    ✅ qa_correctness evaluation completed0:00 |  1.62it/s
2025-08-30 18:10:07,105 - __main__ - INFO -    📊 Running hallucination evaluation...
llm_classify |███████████████████████████████████████████| 5/5 (100.0%) | ⏳ 00:04<00:00 |  1.07it/s
llm_classify |███████████████████████████████████▏        | 4/5 (80.0%) | ⏳ 00:02<00:00 |  2.02it/s2025-08-30 18:10:10,529 - __main__ - INFO -    ✅ hallucination evaluation completed
2025-08-30 18:10:10,529 - __main__ - INFO -    📊 Running toxicity evaluation...
llm_classify |███████████████████████████████████████████| 5/5 (100.0%) | ⏳ 00:03<00:00 |  1.45it/s
llm_classify |                                                     | 0/5 (0.0%) | ⏳ 00:00<? | ?it/2025-08-30 18:10:14,959 - __main__ - INFO -    ✅ toxicity evaluation completed0:03<00:00 |  1.75it/s
2025-08-30 18:10:14,960 - __main__ - INFO - ✅ Phoenix evaluations completed
2025-08-30 18:10:14,960 - __main__ - INFO - 
📊 Phoenix Evaluation Summary:
2025-08-30 18:10:14,960 - __main__ - INFO -   Total queries: 5
2025-08-30 18:10:14,960 - __main__ - INFO -   Successful executions: 5
2025-08-30 18:10:14,960 - __main__ - INFO -   Failed executions: 0
2025-08-30 18:10:14,960 - __main__ - INFO -   Average execution time: 8.79s
2025-08-30 18:10:14,960 - __main__ - INFO - 
🧠 Phoenix Evaluation Results:
2025-08-30 18:10:14,962 - __main__ - INFO -    relevance: {'relevant': np.int64(5)}
2025-08-30 18:10:14,962 - __main__ - INFO -    qa_correctness: {'correct': np.int64(5)}
2025-08-30 18:10:14,962 - __main__ - INFO -    hallucination: {'factual': np.int64(4), 'hallucinated': np.int64(1)}
2025-08-30 18:10:14,962 - __main__ - INFO -    toxicity: {'non-toxic': np.int64(5)}
2025-08-30 18:10:14,962 - __main__ - INFO - 
📊 Quick Scores Summary:
2025-08-30 18:10:14,963 - __main__ - INFO -    Query 1: ✅ relevance: relevant | ✅ qa_correctness: correct | ✅ hallucination: factual | ✅ toxicity: non-toxic
2025-08-30 18:10:14,963 - __main__ - INFO -    Query 2: ✅ relevance: relevant | ✅ qa_correctness: correct | ✅ hallucination: factual | ✅ toxicity: non-toxic
2025-08-30 18:10:14,963 - __main__ - INFO -    Query 3: ✅ relevance: relevant | ✅ qa_correctness: correct | ✅ hallucination: factual | ✅ toxicity: non-toxic
2025-08-30 18:10:14,963 - __main__ - INFO -    Query 4: ✅ relevance: relevant | ✅ qa_correctness: correct | ✅ hallucination: factual | ✅ toxicity: non-toxic
2025-08-30 18:10:14,963 - __main__ - INFO -    Query 5: ✅ relevance: relevant | ✅ qa_correctness: correct | ❌ hallucination: hallucinated | ✅ toxicity: non-toxic
2025-08-30 18:10:14,963 - __main__ - INFO - 
📝 DETAILED EVALUATION RESULTS (FULL EXPLANATIONS):
2025-08-30 18:10:14,963 - __main__ - INFO - ================================================================================
2025-08-30 18:10:14,963 - __main__ - INFO - 
🔍 QUERY 1: Find flights from JFK to LAX
2025-08-30 18:10:14,963 - __main__ - INFO - ------------------------------------------------------------
2025-08-30 18:10:14,963 - __main__ - INFO - 
📊 RELEVANCE: relevant
2025-08-30 18:10:14,963 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,963 - __main__ - INFO - The question asks for flights from JFK to LAX. The reference text provides a list of available flights from JFK to LAX, including the airline codes and aircraft types. This information directly answers the question by listing the flights that are available for the specified route.
2025-08-30 18:10:14,963 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,963 - __main__ - INFO - 
📊 QA_CORRECTNESS: correct
2025-08-30 18:10:14,963 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,963 - __main__ - INFO - The agent provided the list of available flights from JFK to LAX, which is what the user requested. The core information is accurate and matches the reference answer. The duplication of the response does not affect the correctness of the information provided.
2025-08-30 18:10:14,963 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,963 - __main__ - INFO - 
📊 HALLUCINATION: factual
2025-08-30 18:10:14,963 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,963 - __main__ - INFO - The agent's response lists the same flights as the reference text, which are plausible and consistent with the system's capabilities. There is no indication of impossible information or made-up data. The repetition of the list in the response does not indicate hallucination, as it could be a formatting or output issue, not a content issue.
2025-08-30 18:10:14,963 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,963 - __main__ - INFO - 
📊 TOXICITY: non-toxic
2025-08-30 18:10:14,963 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,963 - __main__ - INFO - To determine whether the text is toxic, we need to analyze it based on the criteria provided: hateful statements, demeaning or disparaging language, inappropriate language, or threats of violence. 

1. The text in question is: "Find flights from JFK to LAX."
2. This text is a straightforward request or command to find flights between two airports, JFK (John F. Kennedy International Airport) and LAX (Los Angeles International Airport).
3. There are no words or phrases in this text that express hate or discrimination against any individual or group.
4. The language used is neutral and does not demean or disparage anyone.
5. There is no inappropriate language or any form of threat, whether physical or emotional.

Given these observations, the text does not meet any of the criteria for toxicity. It is a simple, non-offensive statement related to travel.

Therefore, the text is considered non-toxic.
2025-08-30 18:10:14,963 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,963 - __main__ - INFO - ================================================================================
2025-08-30 18:10:14,963 - __main__ - INFO - 
🔍 QUERY 2: Book a flight from LAX to JFK for tomorrow, 2 passengers, business class
2025-08-30 18:10:14,963 - __main__ - INFO - ------------------------------------------------------------
2025-08-30 18:10:14,963 - __main__ - INFO - 
📊 RELEVANCE: relevant
2025-08-30 18:10:14,963 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,963 - __main__ - INFO - 1. The question asks to book a flight from LAX to JFK for tomorrow, for 2 passengers, in business class.
2. The reference text provides details of a flight booking confirmation.
3. The booking confirmation in the reference text is for a flight from LAX to JFK, which matches the route in the question.
4. The reference text specifies the number of passengers as 2, which matches the question.
5. The class of travel in the reference text is business, which matches the question.
6. The departure date in the reference text is 2025-08-06, which is not specified as 'tomorrow' in the question, but the date format suggests it could be a future date relative to the question's context.
7. Overall, the reference text contains information that matches the key details of the question, indicating it is relevant to answering the question.
2025-08-30 18:10:14,963 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,963 - __main__ - INFO - 
📊 QA_CORRECTNESS: correct
2025-08-30 18:10:14,963 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,963 - __main__ - INFO - The agent successfully booked a flight from LAX to JFK for tomorrow, for 2 passengers in business class. The booking confirmation includes a booking ID, route, departure date, number of passengers, class, and total price, which matches the user's request. The duplicate booking message is an additional system message and does not affect the successful completion of the user's request. Therefore, the core functionality worked as expected, and the user received the requested information.
2025-08-30 18:10:14,963 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,963 - __main__ - INFO - 
📊 HALLUCINATION: factual
2025-08-30 18:10:14,963 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,963 - __main__ - INFO - The agent's response contains dynamic data such as booking IDs and dates, which are expected to differ from the reference text. The response provides plausible flight booking information, including a valid route, class, and passenger details. The mention of a duplicate booking is a plausible scenario and does not indicate hallucination. Therefore, the response is factual.
2025-08-30 18:10:14,963 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,963 - __main__ - INFO - 
📊 TOXICITY: non-toxic
2025-08-30 18:10:14,963 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,963 - __main__ - INFO - To determine whether the text is toxic, we need to analyze the content for any signs of hateful language, demeaning statements, inappropriate language, or threats of violence. The text provided is a straightforward request to book a flight from LAX to JFK for two passengers in business class. It does not contain any language that could be considered hateful or demeaning. There are no inappropriate words or phrases, nor are there any threats of physical or emotional violence. The text is purely transactional and focused on travel arrangements, without any negative or harmful language. Therefore, the text does not meet the criteria for toxicity.
2025-08-30 18:10:14,963 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,963 - __main__ - INFO - ================================================================================
2025-08-30 18:10:14,963 - __main__ - INFO - 
🔍 QUERY 3: Book an economy flight from JFK to MIA for next week, 1 passenger
2025-08-30 18:10:14,963 - __main__ - INFO - ------------------------------------------------------------
2025-08-30 18:10:14,963 - __main__ - INFO - 
📊 RELEVANCE: relevant
2025-08-30 18:10:14,963 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,963 - __main__ - INFO - The question asks to book an economy flight from JFK to MIA for next week for 1 passenger. The reference text provides details of a confirmed flight booking from JFK to MIA, specifying that it is for 1 passenger and in economy class. It also includes a departure date, which is in the future (2025-08-12), aligning with the request for a flight 'next week'. Therefore, the reference text contains information that directly answers the question by confirming that such a flight has been booked.
2025-08-30 18:10:14,963 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,964 - __main__ - INFO - 
📊 QA_CORRECTNESS: correct
2025-08-30 18:10:14,964 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,964 - __main__ - INFO - The agent successfully booked an economy flight from JFK to MIA for next week, as requested by the user. The booking details provided include a dynamically generated booking ID, the correct route, a departure date that is dynamically calculated to be next week, the number of passengers, class, and total price. The agent also provided next steps for the user, which are helpful and accurate. Therefore, the core functionality worked as expected, and the user would be satisfied with the response.
2025-08-30 18:10:14,964 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,964 - __main__ - INFO - 
📊 HALLUCINATION: factual
2025-08-30 18:10:14,964 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,964 - __main__ - INFO - The agent's response contains dynamic data such as the booking ID and departure date, which are expected to differ from the reference text. The route, class, and other details are consistent with the request and system capabilities. There is no clearly false information present.
2025-08-30 18:10:14,964 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,964 - __main__ - INFO - 
📊 TOXICITY: non-toxic
2025-08-30 18:10:14,964 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,964 - __main__ - INFO - To determine whether the text is toxic, we need to analyze the content for any signs of hateful language, demeaning statements, inappropriate language, or threats of violence. The text provided is a straightforward request to book a flight from JFK to MIA for one passenger next week. It does not contain any language that could be considered hateful or demeaning. There are no inappropriate words or phrases, nor are there any threats of physical or emotional violence. The text is purely transactional and informational, focusing on the logistics of booking a flight. Therefore, it does not meet any criteria for toxicity.
2025-08-30 18:10:14,964 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,964 - __main__ - INFO - ================================================================================
2025-08-30 18:10:14,964 - __main__ - INFO - 
🔍 QUERY 4: Show me my current flight bookings
2025-08-30 18:10:14,964 - __main__ - INFO - ------------------------------------------------------------
2025-08-30 18:10:14,964 - __main__ - INFO - 
📊 RELEVANCE: relevant
2025-08-30 18:10:14,964 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,964 - __main__ - INFO - The question asks for the user's current flight bookings. The reference text provides detailed information about two current flight bookings, including booking IDs, routes, dates, number of passengers, class, total cost, status, and booking dates. This information directly answers the question by listing the current flight bookings the user has, making the reference text relevant to the question.
2025-08-30 18:10:14,964 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,964 - __main__ - INFO - 
📊 QA_CORRECTNESS: correct
2025-08-30 18:10:14,964 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,964 - __main__ - INFO - The agent successfully provided the user with their current flight bookings. The response includes two bookings with details such as booking ID, route, date, passengers, class, total cost, status, and booking date. The dynamic data such as booking IDs and dates are expected to differ from the reference, but the core functionality of retrieving and displaying the user's current bookings was achieved. Therefore, the user would be satisfied with the information provided.
2025-08-30 18:10:14,964 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,964 - __main__ - INFO - 
📊 HALLUCINATION: factual
2025-08-30 18:10:14,964 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,964 - __main__ - INFO - The response contains dynamic data such as booking IDs, dates, and booking sequences, which are expected to differ from the reference text. The routes, passenger numbers, classes, and statuses are plausible and consistent with the system's capabilities. There is no clearly impossible information or contradictions present.
2025-08-30 18:10:14,964 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,964 - __main__ - INFO - 
📊 TOXICITY: non-toxic
2025-08-30 18:10:14,964 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,964 - __main__ - INFO - To determine whether the text is toxic, we need to evaluate it against the criteria for toxicity: hateful statements, demeaning or disparaging language, inappropriate language, or threats of violence.

1. **Hateful Statements**: The text does not contain any language that expresses hate towards any individual or group.

2. **Demeaning or Disparaging Language**: The text does not demean or disparage any person or group. It is a straightforward request for information about flight bookings.

3. **Inappropriate Language**: There is no use of inappropriate or offensive language in the text.

4. **Threats of Violence**: The text does not contain any threats, whether physical or emotional.

The text is a simple request for information and does not contain any elements that could be considered toxic. Therefore, it is non-toxic.
2025-08-30 18:10:14,964 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,964 - __main__ - INFO - ================================================================================
2025-08-30 18:10:14,964 - __main__ - INFO - 
🔍 QUERY 5: What do passengers say about SpiceJet's service quality?
2025-08-30 18:10:14,964 - __main__ - INFO - ------------------------------------------------------------
2025-08-30 18:10:14,964 - __main__ - INFO - 
📊 RELEVANCE: relevant
2025-08-30 18:10:14,964 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,964 - __main__ - INFO - The question asks about passengers' opinions on SpiceJet's service quality. The reference text provides five reviews from passengers about their experiences with SpiceJet's service. Each review includes specific comments on the service quality, such as 'service is impeccable', 'good service by the crew', 'outstanding service', 'efficient and warm onboard service', and 'service is very good'. These reviews directly address the question by providing insights into passengers' perceptions of the service quality on SpiceJet flights. Therefore, the reference text is relevant to answering the question.
2025-08-30 18:10:14,964 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,964 - __main__ - INFO - 
📊 QA_CORRECTNESS: correct
2025-08-30 18:10:14,964 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,964 - __main__ - INFO - The agent provided 5 reviews about SpiceJet's service quality, which is what the user requested. The reviews include both positive and negative feedback, offering a balanced view of the service quality. This satisfies the user's request for information about passenger opinions on SpiceJet's service quality.
2025-08-30 18:10:14,964 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,964 - __main__ - INFO - 
📊 HALLUCINATION: hallucinated
2025-08-30 18:10:14,964 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,964 - __main__ - INFO - The agent's response contains reviews that are not present in the reference text. The reference text includes positive reviews about SpiceJet's service, while the agent's response includes both positive and negative reviews, some of which are not mentioned in the reference text. This indicates that the agent has generated or retrieved additional reviews that are not part of the provided reference, which could be considered hallucinated information.
2025-08-30 18:10:14,964 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,964 - __main__ - INFO - 
📊 TOXICITY: non-toxic
2025-08-30 18:10:14,964 - __main__ - INFO - 💭 FULL REASONING:
2025-08-30 18:10:14,964 - __main__ - INFO - To determine whether the text is toxic, we need to analyze the content for any signs of hateful language, demeaning statements, inappropriate language, or threats of violence. The text in question is: "What do passengers say about SpiceJet's service quality?"

1. **Hateful Language**: The text does not contain any language that expresses hate towards any individual or group.

2. **Demeaning Statements**: There are no statements that demean or belittle any person or group. The text is a neutral question asking for opinions.

3. **Inappropriate Language**: The text does not use any inappropriate or offensive language.

4. **Threats of Violence**: There are no threats, either physical or emotional, present in the text.

The text is a straightforward question asking for feedback on a service, without any negative or toxic elements. Therefore, it is not toxic.
2025-08-30 18:10:14,964 - __main__ - INFO - ----------------------------------------
2025-08-30 18:10:14,964 - __main__ - INFO - ================================================================================
2025-08-30 18:10:14,964 - __main__ - INFO - 📊 Creating Arize dataset...
llm_classify |███████████████████████████████████████████| 5/5 (100.0%) | ⏳ 00:05<00:00 |  1.04s/it
2025-08-30 18:10:20,197 - __main__ - INFO - ✅ Arize dataset created successfully: RGF0YXNldDozMDQwMjU6cDEreA==
2025-08-30 18:10:20,197 - __main__ - INFO - 📊 Arize dataset created: RGF0YXNldDozMDQwMjU6cDEreA==
2025-08-30 18:10:20,197 - __main__ - INFO - 
✅ Phoenix evaluation complete!
2025-08-30 18:10:20,197 - __main__ - INFO - 🔒 Phoenix cleanup completed
 kaustavghosh@WQ7X9RQ6YW  ~/Desktop/agent-catalog-quickstart/notebooks/flight_search_agent_langraph  ↱ main  
