# Knowledge Base Semantic Search Tool for Customer Support
record_kind: semantic_search

name: search_knowledge_base

description: >
  Search the customer support knowledge base for relevant articles, FAQs, and policies 
  based on customer queries using semantic similarity.

input:
  type: object
  properties:
    query:
      type: string
      description: "Customer's question or issue description"
    category:
      type: string
      enum: ["flights", "policies", "billing", "general"]
      description: "Category to filter search results"
    max_results:
      type: integer
      default: 5
      description: "Maximum number of results to return"
  required: ["query"]

annotations:
  domain: "customer_support"
  search_type: "knowledge_base"
  gdpr_compliant: "true"

secrets:
  - couchbase:
      conn_string: CB_CONN_STRING
      username: CB_USERNAME  
      password: CB_PASSWORD
      certificate: CB_CERTIFICATE

vector_search:
  bucket: customer-support
  scope: knowledge
  collection: articles
  index: knowledge_base_vector_index
  vector_field: content_embedding
  text_field: article_content
  
  embedding_model:
    name: sentence-transformers/all-MiniLM-L12-v2
    
  num_candidates: 10
  
# Additional metadata fields to include in results
metadata_fields:
  - article_id
  - category
  - last_updated
  - confidence_score